<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Budget Tracker Pro</title>
    <!-- Material Components Web CSS -->
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" />
    <!-- Material Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      :root {
        /* Spacing ratios based on Material guidelines */
        --spacing-unit: 16px;
        --small-spacing: calc(var(--spacing-unit) / 2);
        --large-spacing: calc(var(--spacing-unit) * 2);
      }
      body {
        font-family: "Roboto", sans-serif;
        margin: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        background-color: #f5f5f5;
      }
      header {
        background-color: #6200ee;
        color: white;
        padding: var(--spacing-unit);
      }
      header h1 {
        margin: 0;
        font-size: 1.5rem;
      }
      .mdc-tab-bar {
        background-color: white;
      }
      main {
        flex-grow: 1;
        padding: var(--spacing-unit);
      }
      .content-section {
        margin-bottom: var(--large-spacing);
      }
      .section-title {
        margin-bottom: var(--small-spacing);
        font-size: 1.25rem;
        font-weight: 500;
        color: #333;
      }
      .chart-container {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-unit);
        justify-content: center;
        margin-top: var(--spacing-unit);
      }
      .chart-box {
        background: white;
        border-radius: 4px;
        padding: var(--spacing-unit);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        width: 45%;
        min-width: 300px;
        height: 300px;
        display: flex;
        flex-direction: column;
      }
      .chart-box h3 {
        margin-top: 0;
        font-size: 1.2rem;
        color: #333;
        text-align: center;
      }
      .chart-canvas {
        flex-grow: 1;
      }
      /* Card styling for new elements */
      .mdc-card {
        margin: 0 auto var(--large-spacing);
        max-width: 800px;
        padding: var(--spacing-unit);
        background: white;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        border-radius: 4px;
      }
      footer {
        background-color: #6200ee;
        color: white;
        text-align: center;
        padding: var(--spacing-unit);
      }
      .input-group {
        margin-bottom: var(--small-spacing);
      }
    </style>
  </head>
  <body>
    <header class="mdc-top-app-bar">
      <div class="mdc-top-app-bar__row">
        <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
          <h1 class="mdc-top-app-bar__title">Budget Tracker Pro</h1>
        </section>
      </div>
    </header>

    <!-- Tab Bar -->
    <nav class="mdc-tab-bar" id="app-tab-bar">
      <div class="mdc-tab-scroller">
        <div class="mdc-tab-scroller__scroll-area">
          <div class="mdc-tab-scroller__scroll-content">
            <button class="mdc-tab mdc-tab--active" data-tab="income-expenses">
              <span class="mdc-tab__content">
                <span class="mdc-tab__text-label">Income &amp; Expenses</span>
              </span>
              <span class="mdc-tab-indicator mdc-tab-indicator--active">
                <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
              </span>
              <span class="mdc-tab__ripple"></span>
            </button>
            <button class="mdc-tab" data-tab="budget">
              <span class="mdc-tab__content">
                <span class="mdc-tab__text-label">Budget</span>
              </span>
              <span class="mdc-tab-indicator">
                <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
              </span>
              <span class="mdc-tab__ripple"></span>
            </button>
            <button class="mdc-tab" data-tab="extras">
              <span class="mdc-tab__content">
                <span class="mdc-tab__text-label">Extras</span>
              </span>
              <span class="mdc-tab-indicator">
                <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
              </span>
              <span class="mdc-tab__ripple"></span>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <main>
      <!-- Income & Expenses Section -->
      <section id="income-expenses" class="content-section">
        <div class="mdc-card" style="padding: 24px;">
          <h2 class="section-title">Manage Income &amp; Expenses</h2>
          <div class="input-group">
            <div class="mdc-text-field mdc-text-field--outlined">
              <input type="number" id="income-input" class="mdc-text-field__input" placeholder="Income Amount" />
              <label class="mdc-floating-label" for="income-input">Income</label>
              <div class="mdc-line-ripple"></div>
            </div>
            <button id="add-income" class="mdc-button mdc-button--raised" style="margin-left: var(--small-spacing);">
              <span class="mdc-button__label">Add Income</span>
            </button>
          </div>
          <div class="input-group">
            <div class="mdc-text-field mdc-text-field--outlined">
              <input type="number" id="expense-input" class="mdc-text-field__input" placeholder="Expense Amount" />
              <label class="mdc-floating-label" for="expense-input">Expense</label>
              <div class="mdc-line-ripple"></div>
            </div>
            <button id="add-expense" class="mdc-button mdc-button--raised mdc-button--unelevated" style="margin-left: var(--small-spacing);">
              <span class="mdc-button__label">Add Expense</span>
            </button>
          </div>
          <div class="input-group">
            <h3 class="mdc-typography--headline5">Balance: <span id="balance">$0.00</span></h3>
          </div>
          <div class="input-group">
            <h3 class="mdc-typography--subtitle1">Income History</h3>
            <ul id="income-list"></ul>
          </div>
          <div class="input-group">
            <h3 class="mdc-typography--subtitle1">Expense History</h3>
            <ul id="expense-list"></ul>
          </div>
        </div>
      </section>

      <!-- Budget Section -->
      <section id="budget" class="content-section" style="display:none;">
        <div class="mdc-card" style="padding: 24px;">
          <h2 class="section-title">Set &amp; Monitor Budget</h2>
          <div class="input-group">
            <div class="mdc-text-field mdc-text-field--outlined">
              <input type="number" id="income-budget-input" class="mdc-text-field__input" placeholder="Income Budget" />
              <label class="mdc-floating-label" for="income-budget-input">Income Budget</label>
              <div class="mdc-line-ripple"></div>
            </div>
          </div>
          <div class="input-group">
            <div class="mdc-text-field mdc-text-field--outlined">
              <input type="number" id="expense-budget-input" class="mdc-text-field__input" placeholder="Expense Budget" />
              <label class="mdc-floating-label" for="expense-budget-input">Expense Budget</label>
              <div class="mdc-line-ripple"></div>
            </div>
          </div>
          <button id="set-budget" class="mdc-button mdc-button--raised" style="width:100%; margin-bottom: var(--small-spacing);">
            <span class="mdc-button__label">Set Budget</span>
          </button>
          <div class="input-group">
            <h3 class="mdc-typography--subtitle1">Budget Items</h3>
            <ul id="budget-items-list"></ul>
          </div>
          <div class="input-group">
            <h3 class="mdc-typography--subtitle1">Remaining Budget: <span id="remaining-budget">$0.00</span></h3>
          </div>
        </div>
      </section>

      <!-- Extras Section: Ten additional elements for a good budget tracker -->
      <section id="extras" class="content-section" style="display:none;">
        <!-- 1. Expense Categories -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Expense Categories</h2>
          <p>Define and track spending by categories like Food, Utilities, Entertainment, etc.</p>
          <!-- Category input and list can be added here -->
        </div>
        <!-- 2. Savings Goals -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Savings Goals</h2>
          <p>Set targets for savings and monitor progress over time.</p>
        </div>
        <!-- 3. Upcoming Bills & Reminders -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Upcoming Bills</h2>
          <p>List and get reminders for upcoming bills and payments.</p>
        </div>
        <!-- 4. Transaction History Filter -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Transaction History Filter</h2>
          <p>Filter transactions by date, type, or category.</p>
        </div>
        <!-- 5. Budget vs Actual Comparison -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Budget vs Actual</h2>
          <p>Visualize planned versus actual expenses and income.</p>
        </div>
        <!-- 6. Spending Insights & Tips -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Spending Insights</h2>
          <p>Get personalized tips and insights based on your spending habits.</p>
        </div>
        <!-- 7. Overspending Alerts -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Overspending Alerts</h2>
          <p>Receive alerts when spending exceeds your set limits.</p>
        </div>
        <!-- 8. Recurring Transactions -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Recurring Transactions</h2>
          <p>Set up and track recurring income and expenses.</p>
        </div>
        <!-- 9. Net Worth Tracker -->
        <div class="mdc-card" style="padding: 24px; margin-bottom: var(--spacing-unit);">
          <h2 class="section-title">Net Worth Tracker</h2>
          <p>Monitor your assets and liabilities to visualize overall net worth.</p>
        </div>
        <!-- 10. Monthly & Yearly Summary -->
        <div class="mdc-card" style="padding: 24px;">
          <h2 class="section-title">Monthly & Yearly Summary</h2>
          <p>Summarize your financial performance monthly and yearly with detailed reports.</p>
        </div>
      </section>

      <!-- Chart Section -->
      <section class="chart-container">
        <div class="chart-box" id="income-expense-chart-box" style="display:none;">
          <h3>Income &amp; Expenses Over Time</h3>
          <canvas id="incomeExpenseChart" class="chart-canvas"></canvas>
        </div>
        <div class="chart-box" id="budget-overview-chart-box" style="display:none;">
          <h3>Budget Overview</h3>
          <canvas id="budgetOverviewChart" class="chart-canvas"></canvas>
        </div>
      </section>

      <!-- Budget Summary Card -->
      <section class="content-section">
        <div class="mdc-card">
          <h3 class="mdc-typography--headline6">Budget Summary</h3>
          <ul id="budget-summary-list"></ul>
          <p class="mdc-typography--body1">Total Income: <span id="total-income">0</span></p>
          <p class="mdc-typography--body1">Total Expenses: <span id="total-expenses">0</span></p>
          <p class="mdc-typography--body1">Remaining Budget: <span id="remaining-budget-summary">$0.00</span></p>
        </div>
      </section>
    </main>

    <footer>
      <p>© 2024 Budget Tracker Pro. All rights reserved.</p>
    </footer>

    <!-- Material Components Web JS -->
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <script>
      // Initialize Material Components
      mdc.autoInit();

      // Helper for cookies
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        return parts.length === 2 ? parts.pop().split(';').shift() : null;
      }
      function setCookie(name, value, days = 30) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
        const expires = "expires=" + date.toUTCString();
        document.cookie = name + "=" + value + ";" + expires + ";path=/";
      }

      // Initialize cookies if they don't exist
      if (getCookie("income") === null) setCookie("income", 0);
      if (getCookie("expenses") === null) setCookie("expenses", 0);
      if (getCookie("incomeBudget") === null) setCookie("incomeBudget", 0);
      if (getCookie("expenseBudget") === null) setCookie("expenseBudget", 0);
      if (getCookie("budgetItems") === null) setCookie("budgetItems", JSON.stringify([]));
      if (getCookie("incomeHistory") === null) setCookie("incomeHistory", JSON.stringify([]));
      if (getCookie("expenseHistory") === null) setCookie("expenseHistory", JSON.stringify([]));

      let income = parseFloat(getCookie("income")) || 0;
      let expenses = parseFloat(getCookie("expenses")) || 0;
      let incomeBudget = parseFloat(getCookie("incomeBudget")) || 0;
      let expenseBudget = parseFloat(getCookie("expenseBudget")) || 0;
      let budgetItems = JSON.parse(getCookie("budgetItems")) || [];
      const incomeHistory = JSON.parse(getCookie("incomeHistory")) || [];
      const expenseHistory = JSON.parse(getCookie("expenseHistory")) || [];

      // DOM Elements
      const incomeInput = document.getElementById("income-input");
      const expenseInput = document.getElementById("expense-input");
      const addIncomeButton = document.getElementById("add-income");
      const addExpenseButton = document.getElementById("add-expense");
      const balanceDisplay = document.getElementById("balance");
      const incomeList = document.getElementById("income-list");
      const expenseList = document.getElementById("expense-list");
      const incomeBudgetInput = document.getElementById("income-budget-input");
      const expenseBudgetInput = document.getElementById("expense-budget-input");
      const setBudgetButton = document.getElementById("set-budget");
      const budgetItemsList = document.getElementById("budget-items-list");
      const remainingBudgetDisplay = document.getElementById("remaining-budget");
      const budgetSummaryList = document.getElementById("budget-summary-list");
      const totalIncomeDisplay = document.getElementById("total-income");
      const totalExpensesDisplay = document.getElementById("total-expenses");
      const remainingBudgetSummary = document.getElementById("remaining-budget-summary");

      // Tabs setup
      const tabs = document.querySelectorAll(".mdc-tab");
      tabs.forEach((tab) => {
        tab.addEventListener("click", function () {
          tabs.forEach((t) => t.classList.remove("mdc-tab--active"));
          this.classList.add("mdc-tab--active");
          // Show corresponding section, hide others
          document.getElementById("income-expenses").style.display = this.getAttribute("data-tab") === "income-expenses" ? "block" : "none";
          document.getElementById("budget").style.display = this.getAttribute("data-tab") === "budget" ? "block" : "none";
          document.getElementById("extras").style.display = this.getAttribute("data-tab") === "extras" ? "block" : "none";
        });
      });

      // Chart Elements
      const incomeExpenseChartBox = document.getElementById("income-expense-chart-box");
      const budgetOverviewChartBox = document.getElementById("budget-overview-chart-box");

      let incomeExpenseChart, budgetOverviewChart;
      // Sample data for demonstration in absence of historical data
      let sampleDates = [];
      for (let i = 6; i >= 0; i--) {
        let d = new Date();
        d.setDate(d.getDate() - i);
        sampleDates.push(d.toISOString().split("T")[0]);
      }
      const sampleIncomeData = sampleDates.map(() => Math.floor(Math.random() * 200) + 100);
      const sampleExpenseData = sampleDates.map(() => Math.floor(Math.random() * 100) + 50);

      function initCharts() {
        const incomeExpenseCtx = document.getElementById("incomeExpenseChart").getContext("2d");
        incomeExpenseChart = new Chart(incomeExpenseCtx, {
          type: "line",
          data: {
            labels: sampleDates,
            datasets: [
              {
                label: "Income",
                data: incomeHistory.length ? incomeHistory : sampleIncomeData,
                backgroundColor: "rgba(98, 0, 238, 0.2)",
                borderColor: "rgba(98, 0, 238, 1)",
                borderWidth: 2,
                fill: true,
                tension: 0.3,
                pointRadius: 4
              },
              {
                label: "Expenses",
                data: expenseHistory.length ? expenseHistory : sampleExpenseData,
                backgroundColor: "rgba(233, 30, 99, 0.2)",
                borderColor: "rgba(233, 30, 99, 1)",
                borderWidth: 2,
                fill: true,
                tension: 0.3,
                pointRadius: 4
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              x: { title: { display: true, text: "Date" }},
              y: { title: { display: true, text: "Amount ($)" }}
            }
          },
        });

        const budgetOverviewCtx = document.getElementById("budgetOverviewChart").getContext("2d");
        const totalIncomeCalc = income + sampleIncomeData.reduce((sum, val) => sum + val, 0);
        const totalExpensesCalc = expenses + sampleExpenseData.reduce((sum, val) => sum + val, 0);
        const remainingBudgetCalc = totalIncomeCalc - totalExpensesCalc;

        incomeExpenseChartBox.style.display = "flex";
        budgetOverviewChartBox.style.display = "flex";

        budgetOverviewChart = new Chart(budgetOverviewCtx, {
          type: "pie",
          data: {
            labels: ["Income", "Expenses", "Remaining"],
            datasets: [
              {
                data: [totalIncomeCalc, totalExpensesCalc, remainingBudgetCalc],
                backgroundColor: [
                  "rgba(98, 0, 238, 0.7)",
                  "rgba(233, 30, 99, 0.7)",
                  "rgba(158, 158, 158, 0.7)",
                ],
                borderColor: [
                  "rgba(98, 0, 238, 1)",
                  "rgba(233, 30, 99, 1)",
                  "rgba(158, 158, 158, 1)",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
          },
        });
      }

      function updateBalance() {
        const balance = income - expenses;
        balanceDisplay.textContent = "$" + balance.toFixed(2);
        balanceDisplay.style.color = balance >= 0 ? "green" : "red";
        setCookie("income", income);
        setCookie("expenses", expenses);
      }
      
      function renderIncomeHistory() {
        incomeList.innerHTML = "";
        (incomeHistory.length ? incomeHistory : sampleIncomeData).forEach((val) => {
          const li = document.createElement("li");
          li.textContent = "Income: $" + val.toFixed(2);
          incomeList.appendChild(li);
        });
      }
      
      function renderExpenseHistory() {
        expenseList.innerHTML = "";
        (expenseHistory.length ? expenseHistory : sampleExpenseData).forEach((val) => {
          const li = document.createElement("li");
          li.textContent = "Expense: $" + val.toFixed(2);
          expenseList.appendChild(li);
        });
      }
      
      function updateRemainingBudget() {
        const remaining = income - expenses;
        remainingBudgetDisplay.textContent = "$" + remaining.toFixed(2);
        totalIncomeDisplay.textContent = income;
        totalExpensesDisplay.textContent = expenses;
        remainingBudgetSummary.textContent = "$" + remaining.toFixed(2);
      }

      function addIncome() {
        const incomeValue = parseFloat(incomeInput.value);
        if (isNaN(incomeValue) || incomeValue <= 0) {
          alert("Enter a valid income amount.");
          return;
        }
        income += incomeValue;
        incomeHistory.push(incomeValue);
        incomeInput.value = "";
        updateBalance();
        renderIncomeHistory();
        updateRemainingBudget();
        initCharts();
        setCookie("incomeHistory", JSON.stringify(incomeHistory));
      }
      
      function addExpense() {
        const expenseValue = parseFloat(expenseInput.value);
        if (isNaN(expenseValue) || expenseValue <= 0) {
          alert("Enter a valid expense amount.");
          return;
        }
        expenses += expenseValue;
        expenseHistory.push(expenseValue);
        expenseInput.value = "";
        updateBalance();
        renderExpenseHistory();
        updateRemainingBudget();
        initCharts();
        setCookie("expenseHistory", JSON.stringify(expenseHistory));
      }
      
      addIncomeButton.addEventListener("click", addIncome);
      addExpenseButton.addEventListener("click", addExpense);
      
      // Initial setup on page load
      window.addEventListener("load", () => {
        updateBalance();
        renderIncomeHistory();
        renderExpenseHistory();
        updateRemainingBudget();
        initCharts();
      });
    </script>
  </body>
</html>
