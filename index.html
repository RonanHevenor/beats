<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modern Beat Frequency Generator</title>
  <style>
    /* Reset some basic styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box; // 111111111
    }

    body, html {
      width: 100%;
      height: 100%;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      overflow: hidden;
      background-color: #001f3f;
    }

    /* Background canvas styles */
    #backgroundCanvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0;
      width: 100%;
      height: 100%;
    }

    /* Video background styles */
    #rickVideo {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
    }

    /* Container for content as a white box with 100% opacity */
    .container {
      position: relative;
      z-index: 1;
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
      text-align: center;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      top: 50%;
      transform: translateY(-50%);
    }

    h1 {
      margin-bottom: 1rem;
      font-size: 2rem;
      color: #333;
    }

    .slider-container {
      margin: 1rem 0;
      text-align: left;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: #555;
    }

    input[type="range"] {
      width: 100%;
    }

    /* Button styling for play/pause and UN buttons */
    .btn {
      margin-bottom: 1.5rem;
      background-color: #007BFF;
      color: #fff;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-right: 0.5rem;
    }

    .btn:hover {
      background-color: #0056b3;
    }

    .btn:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <canvas id="backgroundCanvas"></canvas>
  <!-- Video element for Rick Astley background -->
  <video id="rickVideo" loop>
    <source src="Rick_Astley_Never_Gonna_Give_You_Up.mp4" type="video/mp4">
  </video>
  <div class="container">
    <h1>Ronan's Beat Frequency Generator</h1>
    <!-- Beat Mode: Play/Pause button controls the slider tones -->
    <button id="playPauseButton" class="btn">&#9658;</button>
    <!-- UN buttons are entirely independent -->
    <button id="un1Button" class="btn">UN 1</button>
    <button id="un2Button" class="btn">UN 2</button>
    <div class="slider-container">
      <label for="freq1">Frequency 1: <span id="freq1Value">440.0</span> Hz</label>
      <input type="range" id="freq1" min="400" max="480" value="440" step="0.1" oninput="updateFrequency()">
    </div>
    <div class="slider-container">
      <label for="freq2">Frequency 2: <span id="freq2Value">445.0</span> Hz</label>
      <input type="range" id="freq2" min="400" max="480" value="445" step="0.1" oninput="updateFrequency()">
    </div>
  </div>

  <script>
    // Use a single audio context for everything.
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // --- Beat Mode Oscillators (Slider Tones) ---
    let osc1 = audioCtx.createOscillator();
    let osc2 = audioCtx.createOscillator();
    let beatGain = audioCtx.createGain();
    beatGain.gain.value = 1;

    osc1.type = 'sine';
    osc2.type = 'sine';
    osc1.frequency.setValueAtTime(440, audioCtx.currentTime);
    osc2.frequency.setValueAtTime(445, audioCtx.currentTime);

    osc1.connect(beatGain);
    osc2.connect(beatGain);
    beatGain.connect(audioCtx.destination);

    let beatOscStarted = false;
    function startBeatOscillators() {
      if (!beatOscStarted) {
        osc1.start();
        osc2.start();
        beatOscStarted = true;
      }
    }

    const playPauseButton = document.getElementById('playPauseButton');
    const freq1Slider = document.getElementById('freq1');
    const freq2Slider = document.getElementById('freq2');
    const freq1ValueEl = document.getElementById('freq1Value');
    const freq2ValueEl = document.getElementById('freq2Value');

    playPauseButton.addEventListener('click', () => {
      startBeatOscillators();
      if (beatGain.gain.value > 0) {
        beatGain.gain.value = 0;
        playPauseButton.innerHTML = "&#9658;";
      } else {
        beatGain.gain.value = 1;
        playPauseButton.innerHTML = "&#10074;&#10074;";
      }
    });

    function updateFrequency() {
      startBeatOscillators();
      const freq1 = parseFloat(freq1Slider.value);
      const freq2 = parseFloat(freq2Slider.value);
      
      freq1ValueEl.textContent = freq1.toFixed(1);
      freq2ValueEl.textContent = freq2.toFixed(1);
      
      osc1.frequency.setValueAtTime(freq1, audioCtx.currentTime);
      osc2.frequency.setValueAtTime(freq2, audioCtx.currentTime);
      
      if (beatGain.gain.value === 0) {
        beatGain.gain.value = 1;
        playPauseButton.innerHTML = "&#10074;&#10074;";
      }
    }

    // --- UN Oscillators (Standalone) ---
    let un1Osc = null;
    let un2Osc = null;
    let un1Playing = false;
    let un2Playing = false;

    const un1Button = document.getElementById('un1Button');
    const un2Button = document.getElementById('un2Button');

    function startUnOsc(frequency) {
      const oscillator = audioCtx.createOscillator();
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(frequency, audioCtx.currentTime);
      oscillator.connect(audioCtx.destination);
      oscillator.start();
      return oscillator;
    }

    un1Button.addEventListener('click', () => {
      if (!un1Playing) {
        un1Osc = startUnOsc(402);
        un1Playing = true;
        un1Button.innerText = "Stop UN 1";
      } else {
        un1Osc.stop();
        un1Osc.disconnect();
        un1Osc = null;
        un1Playing = false;
        un1Button.innerText = "UN 1";
      }
    });

    un2Button.addEventListener('click', () => {
      if (!un2Playing) {
        un2Osc = startUnOsc(405);
        un2Playing = true;
        un2Button.innerText = "Stop UN 2";
      } else {
        un2Osc.stop();
        un2Osc.disconnect();
        un2Osc = null;
        un2Playing = false;
        un2Button.innerText = "UN 2";
      }
    });

    // --- Background Animation (Dots) ---
    const canvas = document.getElementById('backgroundCanvas');
    const ctx = canvas.getContext('2d');
    let dots = [];
    const DOT_COUNT = 100;
    const MAX_DISTANCE = 100;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function Dot() {
      this.x = Math.random() * canvas.width;
      this.y = Math.random() * canvas.height;
      this.vx = (Math.random() - 0.5) * 0.5;
      this.vy = (Math.random() - 0.5) * 0.5;
    }

    for (let i = 0; i < DOT_COUNT; i++) {
      dots.push(new Dot());
    }

    function animateDots() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let dot of dots) {
        dot.x += dot.vx;
        dot.y += dot.vy;
        if (dot.x < 0) dot.x = canvas.width;
        if (dot.x > canvas.width) dot.x = 0;
        if (dot.y < 0) dot.y = canvas.height;
        if (dot.y > canvas.height) dot.y = 0;
      }
      for (let i = 0; i < DOT_COUNT; i++) {
        for (let j = i + 1; j < DOT_COUNT; j++) {
          let dx = dots[i].x - dots[j].x;
          let dy = dots[i].y - dots[j].y;
          let distance = Math.sqrt(dx * dx + dy * dy);
          if (distance < MAX_DISTANCE) {
            let opacity = 1 - distance / MAX_DISTANCE;
            ctx.beginPath();
            ctx.strokeStyle = `rgba(65, 105, 225, ${opacity})`;
            ctx.lineWidth = 1;
            ctx.moveTo(dots[i].x, dots[i].y);
            ctx.lineTo(dots[j].x, dots[j].y);
            ctx.stroke();
          }
        }
      }
      for (let dot of dots) {
        ctx.beginPath();
        ctx.arc(dot.x, dot.y, 3, 0, Math.PI * 2);
        ctx.fillStyle = "#4169E1";
        ctx.fill();
      }
      requestAnimationFrame(animateDots);
    }
    animateDots();

    // --- Background Switcher ---
    // Trigger video playback 10 seconds after the first user interaction.
    const rickVideo = document.getElementById('rickVideo');
    let videoTriggered = false;
    const triggerVideo = () => {
      if (!videoTriggered) {
        videoTriggered = true;
        // Remove muted property so video plays with sound.
        rickVideo.muted = false;
        setTimeout(() => {
          rickVideo.style.display = "block";
          canvas.style.display = "none";
          rickVideo.volume = 2; // Note: Browsers may cap volume at 1.
          rickVideo.play().catch(err => console.error("Video play failed: ", err));
        }, 10000);
      }
    };

    // Listen for a user interaction to trigger the video timer.
    const interactionHandler = () => {
      triggerVideo();
      document.removeEventListener('click', interactionHandler);
      document.removeEventListener('keydown', interactionHandler);
    };
    document.addEventListener('click', interactionHandler);
    document.addEventListener('keydown', interactionHandler);
  </script>
</body>
</html>
