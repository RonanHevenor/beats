<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modern Beat Frequency Generator</title>
  <style>
    /* Reset some basic styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body, html {
      width: 100%;
      height: 100%;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      overflow: hidden;
      /* Dark blue background */
      background-color: #001f3f;
    }
    
    /* Background canvas styles */
    #backgroundCanvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0;
      width: 100%;
      height: 100%;
    }
    
    /* Container for content as a white box with 100% opacity */
    .container {
      position: relative;
      z-index: 1;
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
      text-align: center;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      top: 50%;
      transform: translateY(-50%);
    }
    
    h1 {
      margin-bottom: 1rem;
      font-size: 2rem;
      color: #333;
    }
    
    .slider-container {
      margin: 1rem 0;
      text-align: left;
    }
    
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: #555;
    }
    
    input[type="range"] {
      width: 100%;
    }
    
    /* Button styling for play/pause and unknown play */
    .btn {
      margin-bottom: 1.5rem;
      background-color: #007BFF;
      color: #fff;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-right: 0.5rem;
    }
    
    .btn:hover {
      background-color: #0056b3;
    }
    
    .btn:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <canvas id="backgroundCanvas"></canvas>
  <div class="container">
    <h1>Beat Frequency Generator</h1>
    <!-- Existing play/pause button -->
    <button id="playPauseButton" class="btn">&#9658;</button>
    <!-- New play unknown button -->
    <button id="playUnknownButton" class="btn">Play Unknown</button>
    <div class="slider-container">
      <label for="freq1">Frequency 1: <span id="freq1Value">440.0</span> Hz</label>
      <input type="range" id="freq1" min="400" max="480" value="440" step="0.1" oninput="updateFrequency()">
    </div>
    <div class="slider-container">
      <label for="freq2">Frequency 2: <span id="freq2Value">445.0</span> Hz</label>
      <input type="range" id="freq2" min="400" max="480" value="445" step="0.1" oninput="updateFrequency()">
    </div>
    <div class="slider-container">
      <label>Beat Frequency: <span id="beatFrequency">5.0</span> Hz</label>
    </div>
  </div>

  <script>
    // Audio context setup and oscillators
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    let osc1 = audioCtx.createOscillator();
    let osc2 = audioCtx.createOscillator();

    osc1.type = 'sine';
    osc2.type = 'sine';

    // Initial frequency values
    osc1.frequency.setValueAtTime(440, audioCtx.currentTime);
    osc2.frequency.setValueAtTime(445, audioCtx.currentTime);

    // Connect oscillators to destination
    osc1.connect(audioCtx.destination);
    osc2.connect(audioCtx.destination);

    // flag to check if oscillators are started
    let audioStarted = false;
    // flag to check unknown button state
    let usingUnknown = false;

    // Get DOM elements
    const playPauseButton = document.getElementById('playPauseButton');
    const playUnknownButton = document.getElementById('playUnknownButton');
    const freq1Slider = document.getElementById('freq1');
    const freq2Slider = document.getElementById('freq2');

    // Play/Pause toggle button event
    playPauseButton.addEventListener('click', () => {
      if (usingUnknown) return; // Do nothing if unknown mode is active
      if (!audioStarted) {
        // Start audio context if needed and start oscillators
        if (audioCtx.state === 'suspended') {
          audioCtx.resume().then(() => {
            playPauseButton.innerHTML = "&#10074;&#10074;"; // pause icon
          });
        } else {
          osc1.start();
          osc2.start();
          playPauseButton.innerHTML = "&#10074;&#10074;"; // pause icon
        }
        audioStarted = true;
      } else {
        // Toggle audio context state
        if (audioCtx.state === 'running') {
          audioCtx.suspend().then(() => {
            playPauseButton.innerHTML = "&#9658;"; // play icon
          });
        } else {
          audioCtx.resume().then(() => {
            playPauseButton.innerHTML = "&#10074;&#10074;"; // pause icon
          });
        }
      }
    });

    // Play Unknown button event listener
    playUnknownButton.addEventListener('click', () => {
      usingUnknown = true;
      // Disable play/pause button and sliders
      playPauseButton.disabled = true;
      freq1Slider.disabled = true;
      freq2Slider.disabled = true;

      // Generate unknown frequencies in the range 400-480 Hz
      const unknownFreq1 = Math.random() * (480 - 400) + 400;
      const unknownFreq2 = Math.random() * (480 - 400) + 400;

      // Update display
      document.getElementById('freq1Value').innerText = unknownFreq1.toFixed(1);
      document.getElementById('freq2Value').innerText = unknownFreq2.toFixed(1);
      const beatFreq = Math.abs(unknownFreq1 - unknownFreq2);
      document.getElementById('beatFrequency').innerText = beatFreq.toFixed(1);

      // If audio hasn't started already, start the oscillators
      if (!audioStarted) {
        if (audioCtx.state === 'suspended') {
          audioCtx.resume().then(() => {
            osc1.start();
            osc2.start();
          });
        } else {
          osc1.start();
          osc2.start();
        }
        audioStarted = true;
      }
      
      // Set oscillators to unknown frequencies
      osc1.frequency.setValueAtTime(unknownFreq1, audioCtx.currentTime);
      osc2.frequency.setValueAtTime(unknownFreq2, audioCtx.currentTime);
      
      // Optionally, if desired, suspend play/pause toggling:
      playUnknownButton.innerText = "Unknown Mode Active";
      playUnknownButton.disabled = true;
    });

    function updateFrequency() {
      if (usingUnknown) return; // prevent updating if unknown mode is active
      const freq1 = parseFloat(freq1Slider.value);
      const freq2 = parseFloat(freq2Slider.value);
      
      document.getElementById('freq1Value').innerText = freq1.toFixed(1);
      document.getElementById('freq2Value').innerText = freq2.toFixed(1);
      
      osc1.frequency.setValueAtTime(freq1, audioCtx.currentTime);
      osc2.frequency.setValueAtTime(freq2, audioCtx.currentTime);
      
      const beatFreq = Math.abs(freq1 - freq2);
      document.getElementById('beatFrequency').innerText = beatFreq.toFixed(1);
    }

    // Background animation: neon-light royal blue dots with connecting lines
    const canvas = document.getElementById('backgroundCanvas');
    const ctx = canvas.getContext('2d');
    let dots = [];
    const DOT_COUNT = 100;
    const MAX_DISTANCE = 100;

    // Set canvas size
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // Dot constructor function
    function Dot() {
      this.x = Math.random() * canvas.width;
      this.y = Math.random() * canvas.height;
      this.vx = (Math.random() - 0.5) * 0.5;
      this.vy = (Math.random() - 0.5) * 0.5;
    }

    // Initialize dots
    for (let i = 0; i < DOT_COUNT; i++) {
      dots.push(new Dot());
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // Update dot positions
      for (let dot of dots) {
        dot.x += dot.vx;
        dot.y += dot.vy;

        // Wrap around edges
        if (dot.x < 0) dot.x = canvas.width;
        if (dot.x > canvas.width) dot.x = 0;
        if (dot.y < 0) dot.y = canvas.height;
        if (dot.y > canvas.height) dot.y = 0;
      }

      // Draw lines between close dots with neon-light royal blue color
      for (let i = 0; i < DOT_COUNT; i++) {
        for (let j = i + 1; j < DOT_COUNT; j++) {
          let dx = dots[i].x - dots[j].x;
          let dy = dots[i].y - dots[j].y;
          let distance = Math.sqrt(dx * dx + dy * dy);
          if (distance < MAX_DISTANCE) {
            let opacity = 1 - distance / MAX_DISTANCE;
            ctx.beginPath();
            ctx.strokeStyle = `rgba(65, 105, 225, ${opacity})`;
            ctx.lineWidth = 1;
            ctx.moveTo(dots[i].x, dots[i].y);
            ctx.lineTo(dots[j].x, dots[j].y);
            ctx.stroke();
          }
        }
      }

      // Draw neon-light royal blue dots
      for (let dot of dots) {
        ctx.beginPath();
        ctx.arc(dot.x, dot.y, 3, 0, Math.PI * 2);
        ctx.fillStyle = "#4169E1";
        ctx.fill();
      }
      requestAnimationFrame(animate);
    }
    animate();
  </script>
</body>
</html>
